
<html>
  <body>
    <form onsubmit="saveToLocalStorage(event)">
        <label for="candyName">CandyName</label>
        <input type="text" id="candyName" name="candyName">
        <label for="description">Description</label>
        <input type="text" id="description" name="description">
        <label for="price">Price</label>
        <input type="number" id="price" name="price">
        <label for="quantity">Quantity</label>
        <input type="number" id="quantity" name="quantity">
        <button>Add Candy</button>
    </form>
    <!-- <br>
    <button type="button" onclick="removeCandy()">Buy One</button>
    <button type="button" onclick="removeCandy()">Buy Two</button>
    <button type="button" onclick="removeCandy()">Buy Three</button>
    <br> -->

    <ul id="listOfCandies"> </ul>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/1.3.4/axios.min.js"></script>

    <script>
      const base_url = "https://crudcrud.com/api/71c548d6677744b794280bbf61c9ebbf";

      function saveToLocalStorage(event) {
        event.preventDefault();
        const candyName = event.target.candyName.value;
        const description = event.target.description.value;
        const price = event.target.price.value;
        const quantity = event.target.quantity.value;
        const candy = {
          name: candyName,
          description,
          price,
          quantity
        };
        
        axios.post(`${base_url}/candies`, candy)
          .then((response) => {
            showCandiesOnScreen(response.data);
            showCandies();
          })
          .catch((err) => {
            document.body.innerHTML += "<h3> Something went wrong</h3>";
            console.log(err);
          });

        event.target.reset();
      };

      function showCandies() {
        axios.get(`${base_url}/candies`)
          .then((response) => {
            const parentElement = document.getElementById('listOfCandies');
            parentElement.innerHTML = "";
            for (var i = 0; i < response.data.length; i++) {
              showCandiesOnScreen(response.data[i], parentElement);
            }
          })
          .catch((err) => {
            console.log(err);
          });
      }

      window.addEventListener("DOMContentLoaded", showCandies);

      function showCandiesOnScreen(candy, parentElement) {
        parentElement = parentElement || document.getElementById('listOfCandies');

        const childElem = document.createElement('li');
        childElem.textContent = candy.name + ' - ' + candy.description + ' - ' + candy.price + ' - ' + candy.quantity ;

        const userInputDiv = document.createElement('div');
        userInputDiv.innerHTML=`Candy Name: ${candy.name}<br>Description: ${candy.description}<br>Price: ${candy.price}<br>Quantity: ${candy.quantity}`;
        childElem.appendChild(userInputDiv);


        const deletebtn = document.createElement('input');
        deletebtn.type = 'button';
        deletebtn.value = 'buy One';
        deletebtn.onclick = () => {
          axios
          .delete(`${base_url}/candies/${candy._id}`)
            .then(() => {
              parentElement.removeChild(childElem);
            })
            .catch((err) => {
              document.body.innerHTML += "<h3> Something went wrong</h3>";
              console.log(err);
            });
        };
        childElem.appendChild(deletebtn);
        parentElement.appendChild(childElem);

        
        const itemName = document.getElementById('candyName');
        const itemDescription = document.getElementById('description');
        const itemPrice = document.getElementById('price');
        const itemQuantity = document.getElementById('quantity');
        const buyOneBtn = document.createElement('input');
        const buyTwoBtn = document.createElement('input');
        const buyThreeBtn = document.createElement('input');

        buyOneBtn.type = 'button';
        buyOneBtn.value = 'Buy One';
        buyOneBtn.addEventListener('click', function() {
        itemQuantity.textContent = parseInt(itemQuantity.textContent) - 1;
        });

        buyTwoBtn.type = 'button';
        buyTwoBtn.value = 'Buy Two';
        buyTwoBtn.addEventListener('click', function() {
        itemQuantity.textContent = parseInt(itemQuantity.textContent) - 2;
        });

        buyThreeBtn.type = 'button';
        buyThreeBtn.value = 'Buy Three';
        buyThreeBtn.addEventListener('click', function() {
        itemQuantity.textContent = parseInt(itemQuantity.textContent) - 3;
        });
    }

        childElem.appendChild(itemName);
        childElem.appendChild(itemDescription);
        childElem.appendChild(itemPrice);
        childElem.appendChild(itemQuantity);
        childElem.appendChild(buyOneBtn);
        childElem.appendChild(buyTwoBtn);
        childElem.appendChild(buyThreeBtn);
        showCandiesOnScreen();
        
        